---
title: 'Configuration'
description: 'Walkthrough on configuring the integration'
---

Implementing Thales CipherTrust Manager with EDB Postgres Advanced Server 15.2 and above requires the following components:

- EDB Postgres Advanced Server version 15.2 or above
- Thales CipherTrust Manager
- [Pykmip](https://pypi.org/project/PyKMIP/#files)
- Python  

## Prerequisites

- A running EDB Postgres Advanced Server instance.
- Thales CipherTrust Manager installed and deployed per your environment.

## Configure Thales CipherTrust Manager for EDB Postgres Advanced Server

Follow the steps outlined below to create the required certificates after you have successfully gotten Thales CipherTrust Manger up and running.


## Login to Thales CipherTrust Manager and Create User
A user needs to be created for future authentication when creating a key on Thales CipherTrust Manager with EDB Postgres Advanced Server.  It verifies the username and password against the Thales CipherTrust Manager internal database.

1. Login to the Thales CipherTrust Manager UI.
    
    ![Thales CipherTrust Manager Login](Images/ThalesCipherTrustLoginScreen.png)

2. Navigate to the Access Management section and select `Users`.

3. Select `Add Users` and provide the required information:
- Username
- Password

4. Click on `Add User`.

    ![Thales CipherTrust Manager Add User](Images/ThalesCipherTrustAddUser.png)

5. Click on the `...` beside the user you just created and select the View/Edit option.

6. Click on `Expand All` and select/add the following groups for the user:
- `Key Admins`
- `Key Users`
- `All Clients`

The user that you created now has the appropriate settings and permissions to create and download certificates in Thales.

## Create and Download Certificates on Thales CipherTrust Manager

You will need `ca.pem`, `key.pem` and `cert.pem` certificates generated in Thales CipherTrust Manager for your KMIP server and pykmip.conf file.

### Download the CA Certificate

The local CA Certificate is provided by default and the below steps will show you how to access and download it for your pykmip.conf file.

1. Navigate to CA on the left-hand side and click on `Local` to be taken to the Local Certificate Authorities page.

2. Click on the `...` on the far right side and click `Download`.

    ![Thales CipherTrust Manger CA Certificate](Images/ThalesCipherTrustCACert.png)

3. For your download change the name from `Certificate.pem` to `ca.pem`.  Keep track of where you downloaded your certificate as you will need it later.

### Create and Download the Key.pem and Cert.pem Certificates

These are the other two certificates you will need for your KMIP server and pykmip.conf file.

1. Navigate back to the Thales CipherTrust Manager main page.

2. On the main page, select `KMIP` from options under Products.

3. Click on `Client Profile` and select `Add Profile`.

4. Give the profile a name and select `Save`.  In our example we used `newtestprofile`.

    ![Thales CipherTrust Manager Add Client Profile](Images/ThalesCipherTrustManagerAddClientProfile.png)

5. Click on `Registration Token` and select `New Registration Token`.

6. Click on `Begin` and then follow the below steps to configure your token:
- Give the token a name, in our example `edbnewtoken2`
    ![Create New Registration Token Name](Images/CreateNewRegistrationTokenName.png)
- Select `local CA`
    ![Create New Registration Token CA](Images/CreateNewRegistrationTokenCA.png)
- Select the Client Profile you created above, in our example `newtestprofile`
    ![Create New Registration Token Select Profile](Images/CreateNewRegistrationTokenSelectProfile.png)
- Select `Create Token`
- Copy the Token that was created
    ![Create New Registration Token Copy Token](Images/CreateNewRegistrationTokenCopyToken.png)
- Click on `Done`

7. Navigate to Registered Clients and select `Add Client`.

8. Give the Client a name.

9. Paste the token that you copied above into the `Registration Token` box and then press `Save`. This will generate the final two certificates.
    ![Thales Create New Registration Client](Images/ThalesRegistrationClient.png) 

10. Click on `Save Private Key` and click on `Save Certificate`, to download the final two certificates.  Make sure to note their downloaded location for later.
    ![Thales Download Certificate Files](Images/ThalesDownloadCerts.png)

You are now ready to use Thales CipherTrust Manager and EDB Postgres Advanced Server with TDE for key management.