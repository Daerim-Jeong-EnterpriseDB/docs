---
title: "Upgrading a PEM installation on a Linux host"
legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-enterprise-manager/installation-getting-started/upgrade-migration-guide/8.0/upgrading_pem_installation_linux_rpm.html"
redirects:
- /pem/latest/pem_upgrade/01_upgrading_pem_installation/02_upgrading_pem_installation_linux_rpm/
- /pem/latest/pem_upgrade/upgrading_pem_installation/upgrading_pem_installation_linux_rpm/
---

To upgrade PEM component software on Linux hosts, install a newer version of the PEM component packages in the following order:

1.  Invoke the PEM agent package installer on each monitored node except the PEM server host.
2.  Invoke the PEM server package installer. It upgrades both the PEM server and the PEM agent that resides on the PEM server host.

During an installation, the component installation automatically detects an existing installation and performs an upgrade. After upgrading the PEM agent and server, you can upgrade SQL Profiler if required. That step is platform specific.

!!! Note
    If you already configured or are planning to configure any shell/batch script run by a Linux agent that's upgraded from any earlier version to version 7.11 or later, you must speciy the user for the `batch_script_user` parameter in the `agent.cfg` file. We strongly recommended that you use a non-root user to run the scripts. Using the root user can result in compromising the data security and operating system security. However, if you want to restore the pemagent to its original settings using a root user to run the scripts, then you must set the `batch_script_user` parameter to `root`.

## Upgrading a PEM server installation

The commands to upgrade the PEM server are platform specific. 

If you want to upgrade a PEM server that is installed on a machine in an isolated network, you need to create a PEM repository on that machine before you upgrade the PEM server. For more information about creating a PEM repository on an isolated network, see [Creating a PEM Repository on an Isolated Network](/pem/latest/installing/creating_pem_repository_in_isolated_network/).

### On a CentOS, Rocky Linux, AlmaLinux, or RHEL host

To use an RPM package to upgrade an existing RPM installation, you can use the `yum` package manager to upgrade the installed version of the PEM server on CentOS/RHEL 7.x or Rocky Linux/AlmaLinux/RHEL 8.x:

```shell
yum upgrade edb-pem
```

You can also use the `dnf` command on Rocky Linux/AlmaLinux/RHEL 8.x:

```shell
dnf upgrade edb-pem
```

!!! Note
    If you're doing a fresh installation of the PEM server on CentOS or RHEL 7.x host, the installer installs the `edb-python3-mod_wsgi` package along with the installation. The package is a requirement of the operating system. If you are upgrading the PEM server on CentOS or RHEL 7.x host, the`the edb-python3-mod_wsgi` packages replaces the `mod_wsgi package`  package to meet the requirements of the operating system.

After upgrading the PEM server using yum or the `dnf` command, you must configure the PEM server. For detailed information, see [Configuring the PEM server](#configuring-the-pem-server).

### On a Debian or Ubuntu host

You can use the `apt-get` package manager to upgrade the installed version of the PEM server on supported versions of Debian or Ubuntu:

```shell
apt-get upgrade edb-pem
```

After upgrading the PEM server with `apt-get`, you need to configure the PEM server. For detailed information, see [Configuring the PEM server](#configuring-the-pem-server).

### On a SLES host

You can use the zypper package manager to upgrade the installed version of the PEM Server on supported versions of a SLES host:

```shell
zypper update edb-pem
```

After upgrading the PEM server using zypper, you need to configure the PEM server. For detailed information, see [Configuring the PEM server](#configuring-the-pem-server).

!!! Note
    If you upgrade the PEM backend database server and the PEM server, update the `PG_INSTALL_PATH` and `DB_UNIT_FILE` parameters pointing to the new version in the `/usr/edb/pem/share/.install-config` file before you run the configure script.

## Configuring the PEM server

After upgrading the PEM server, you can use the following command to configure the PEM server:

```shell
/usr/edb/pem/bin/configure-pem-server.sh
```

The configure script uses the values from the old PEM server configuration file while running the script.

For detailed information, see [Configuring the PEM server on Linux platforms](/pem/latest/installing/configuring_the_pem_server_on_linux/).

!!! Note
    - The configure script requires a superuser password only after the upgrade process.

    - If your configure script gets stuck, then stop the PEM agent with `alert_threads>0`. To get the details of such agents, execute the query:

      ```sql
      SELECT agent_id FROM pem.agent_config WHERE param='alert_threads' AND value > 0;
      ```

      Stop the running agents and re-run the configure script.

      If the problem persists, then run the query to terminate the stuck alert processes:

      ```sql
      SELECT pg_terminate_backend(pid) FROM pg_stat_activity WHERE query='SELECT pem.process_one_alert()';
      ```

      Then re-run the configure script.

## Upgrading a PEM agent installation

The commands to upgrade the PEM agent are platform specific. 

### On a CentOS or RHEL host

For CentOS or RHEL 7.x or RHEL 8.x, use the following command:

```shell
yum upgrade edb-pem-agent
```

For Rocky Linux or AlmaLinux or RHEL 8.x, you can also use the following command:

```shell
dnf upgrade edb-pem-agent
```

### On a Debian or Ubuntu host

For Debian or Ubuntu, use the following command:

```shell
apt-get upgrade edb-pem-agent
```

### On a SLES host

For SLES, use the following command:

```shell
zypper update edb-pem-agent
```

