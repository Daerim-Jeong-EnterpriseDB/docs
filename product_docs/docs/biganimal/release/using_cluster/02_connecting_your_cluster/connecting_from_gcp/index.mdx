---
title: Connecting from Google Cloud
---

If you are using your own Google Cloud account, you can use Google Cloud [Private Service Connect (PSC)](https://cloud.google.com/vpc/docs/configure-private-service-connect-producer) to publish services using internal IP addresses in your VPC network. PSC is a network interface that securely connects a private IP address from your Google Cloud VPC to an external service. You grant access only to a single cluster instead of the entire BigAnimal resource VPC, thus ensuring maximum network isolation. 

PSC provides two methods to connect to published services: using PSC-connected endpoints or load balancers (also referred to as PSC backends). We provide step-by-step directions in the knowledge base for the method using load balancers (see [Connect to BigAnimal private cluster using GCP Private Service Connect](https://support.biganimal.com/hc/en-us/articles/20383247227801-GCP-Connect-to-BigAnimal-private-cluster-using-GCP-Private-Service-Connect)). PSC backends use a load balancer configured with PSC network endpoint group (NEG) backends. For more information, see [About Private Service Connect backends](https://cloud.google.com/vpc/docs/private-service-connect-backends) and [Create a Private Service Connect backend](https://cloud.google.com/vpc/docs/access-apis-managed-services-private-service-connect-backends).

While we recommend using PSC-connected endpoints when using your own Google Cloud account, another option is VPC peering. See [VPC peering](vpc_peering) for more information.

## PSC-connected endpoint

The way you create a private PSC-connected endpoint differs when you're using your Google Cloud project versus using BigAnimal's cloud account.

### Using BigAnimal's cloud account

When using BigAnimal's cloud account, you provide BigAnimal with your Google Cloud project ID when creating a cluster (see [Networking](/biganimal/latest/getting_started/creating_a_cluster/#network-logs--telemetry-section)). BigAnimal, in turn, provides you with a Google Cloud Service Attachment, which you can use to connect to your cluster privately.

1. When creating your cluster, on the **Cluster Settings** tab, in the **Network** section:
   1. Select **Private**.

   1. Enter your application's Google Cloud project ID.

1. After the cluster is created, go to the cluster details to see the corresponding Service Attachment. You need the Service Attachment while creating a PSC-connected endpoint.

1. Create a connected endpoint in the client's VPC. The steps for creating a connected endpoint in the client's VPC are the same whether you're using BigAnimal's cloud or your cloud. The steps are available [here](#step-2-create-a-vpc-endpoint-in-the-clients-vpc).

1. In your application's Google Cloud, select **Private Service Connect**, and then select **Connected Endpoints**. Select the endpoint you created previously, and use the Service Attachment provided in the details section in BigAnimal to access your cluster.

### Using your own Google Cloud account

Two different methods enable you to connect to your private cluster from your application's VPC in Google Cloud. Each method offers different levels of accessibility and security. The PSC-connected endpoint method is recommended and is most commonly used. However, you can also use the VPC peering connection method if required by your organization.

--------------- 
Remainder of topic is copied from AWS topic - it hasn't been checked by Jason, but some references to AWS have been changed to GCP 
---------------
### PSC-connected endpoint example

This example shows how to connect your cluster using PSC-connected endpoints.

Assume that your cluster is on a project called `development` and is being accessed from a client on another account called `test`. It has the following properties:

-   BigAnimal cluster:
    -   Google Cloud project: `development`
    -   Amazon resource name (ARN): `arn:aws:iam::123456789123:root`
    -   Cluster ID: `p-mckwlbakq5` 
    -   Account ID: `brcxzr08qr7rbei1` 
    -   Organization's domain name: `biganimal.io`

-   Client:
    -   AWS account: `test`
    -   Resource group: `rg-client`
    -   VPC: `vpc-client`
    -   VPC subnet: `snet-client`

#### Prerequisites

To walk through an example in your own environment, you need:

- Your cluster URL. You can find the URL in the **Connect** tab of your cluster instance in the BigAnimal portal.


#### Step 1: Create an endpoint service for your cluster

In the Google Cloud project connected to BigAnimal, create a PSC-connected endpoint to provide access to your clusters from other VPCs in other Google Cloud projects. Perform this procedure for each cluster to which you want to provide access.

1. Open the [Amazon EC2 console](https://console.aws.amazon.com/ec2/). Ensure that the region where your cluster is deployed is selected in the upper-right corner of the console.

1. In the navigation pane, under **Load Balancing**, select **Load Balancers**.

1. Identify the load balancer that's tagged with the ID of the cluster to which you want to connect (`<cluster-id>-rw-internal-lb`), for example, `p-96fh28m3cb-rw-internal-lb`. Note the name of that network load balancer.

1. Open the [Amazon VPC console](https://console.aws.amazon.com/vpc/). 

1. From the navigation pane on the left, under **Virtual Private Cloud**, select **Endpoint Services**, and then select **Create endpoint service**.

1. Enter a suitable name for the endpoint service.

1. Select **Network** for the load balancer type.

1. Under **Available load balancers**, select the network load balancer of the cluster to which you want to connect. 
 
1. Leave all the other fields with their default values, and select **Create**. 

1. Under **Details**, note the **Service name** of the created endpoint service (for example, `com.amazonaws.vpce.us-east-1.vpce-svc-0e123abc123198abc`). You need the service name while creating a VPC endpoint.

1. In the navigation pane, select **Endpoint Services**.

1. Select your endpoint service from the **Actions** list, and select **Allow principals**.
 
1. Add the AWS account with which you want to connect to the endpoint service by specifying the ARN for the principal. The ARN must be in this format:

 arn:aws:iam::&lt;AWS ACCOUNT ID&gt;:root


#### Step 2: Create a VPC endpoint in the client's VPC

Now that your endpoint service is created, you can connect it to the cluster VPC using a VPC endpoint. Perform this procedure in your application's AWS account. 

!!! Note
    In your application's AWS account, ensure that you allow your application's security group to connect to your cluster.

1. Open the [Amazon VPC console](https://console.aws.amazon.com/vpc/).

1. Ensure that the region where your cluster is deployed is selected in the upper-right corner of the console.

1. From the navigation pane on the left, under **Virtual Private Cloud**, select **Endpoints**, and then select **Create endpoint**.

1. Enter a suitable name for the endpoint service.

1. Under **Service category**, select **Other endpoint services**.

1. Under **Service Name**, enter the name of the endpoint service that you created earlier:
   
   -  If following the example using your own AWS account: `com.amazonaws.vpce.us-east-1.vpce-svc-0e123abc123198abc`
   -  If using BigAnimal's cloud: the service name provided in your BigAnimal cluster's details 
   
   To verify whether you successfully allowed access to the endpoint, select **Verify service**.

1. Under VPC, select the client's VPC in which to create the endpoint. 

1. Under **Subnets**, select the subnets (availability zones) in which to create the endpoint network interfaces. Enable the endpoint in all availability zones used by your application.

1. Select **Create endpoint**.

#### Step 3: Accept and test the connection

1. In your AWS account connected to BigAnimal, select **VPCs**, and then select **Endpoint services**. 

1. Select the endpoint service instance you created previously, and accept the endpoint connection request under **Endpoint connections**. 

1. You can now successfully connect to your cluster.

 In your application's AWS account, select **VPC** and then select **Endpoints**. Select the endpoint you created previously and use the DNS name provided in the details section to access your cluster.
