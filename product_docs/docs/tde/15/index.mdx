---
title: "Transparent Data Encryption"
hideVersion: true
navigation:
- differences
- enabling_tde
- key_stores
- troubleshooting
- backups
- pg_upgrade
- regress_run
---


Transparent data encryption (TDE) is an optional feature supported by version 15 of EDB Postgres Advanced Server and EDB Postgres Extended Server with high availability. 

It encrypts, transparently to the user, any user data stored in the database system. User data includes the actual data stored in tables and other objects, as well as system catalog data such as the names of objects.

![TDE diagram](/images/tde1.png)

## What is and is not encrypted with TDE?

TDE encrypts:

- The files underlying tables, sequences, indexes, including TOAST tables and system catalogs, and including all forks. (We shall call these the “data files” below.)

- The write-ahead log (WAL). 

- Various temporary files that are used during query processing and the operation of the database system.

!!! Note Implications

    - Any WAL fetched from a server using TDE, including via streaming replication and archiving, is encrypted.

    - A physical replica is necessarily encrypted (or not encrypted) in the same way and using the same keys as its primary server.

    - If a server uses TDE, a base backup is automatically encrypted. 


The following are not encrypted or otherwise disguised by TDE:

- Metadata internal to the operation of the database system that does not contain user data, such as the transaction status (e.g., pg_subtrans, pg_xact).

- The file names and file system structure in the data directory. (That means, the overall size of the database system, the number of databases, the number of tables, their relative sizes, as well as file-system metadata such as last access time are all visible without decryption.)

- Data in foreign tables.

- The server diagnostics log.

- Configuration files.

!!! Note Implications

    Logical replication is not affected by TDE. Publisher and subscriber can have different encryption settings. The payload of the logical replication protocol is not encrypted. (Of course, SSL can be used.)

### How is performance affected? 

??? See notes in slidedeck

### How does this relate to regulatory compliance?

???

## How does TDE work?

TDE prevents unauthorized viewing of data in operating system files on the database server and on backup storage. Data will be unintelligible for unauthorized users if stolen or misplaced.

Data encryption and decryption is managed by the database and does not require application changes or updated client drivers.

EDB Postgres Advanced Server and EDB Postgres Extended Server provide hooks to key management that is external to the database allowing for simple passphrase encrypt/decrypt or integration with enterprise key management solutions. See [key management](/key_stores) for more information.

[Maybe: Crypto-shredding]

### How is data encrypted with TDE? 

The data files are encrypted using AES-128-XTS. The XTS “tweak” uses the database OID, the relfilenode, and the block number.

The WAL is encrypted using AES-128-CTR. The “counter” includes the WAL LSN.

Temporary files that are accessed by block are also encrypted using AES-128-XTS. Other temporary files are encrypted using AES-128-CBC.

### How is data stored on disk with TDE?

(current: slidedeck example)
















